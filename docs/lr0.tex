\documentclass[12pt,a4paper]{extarticle}
\input{configs/title.tex}

\begin{document}

\maketitlepage{0}

% Оглавление
\tableofcontents
\newpage

% Разделы
\section{Цель работы}
\normalfont Освоить на практике принципы объектно-ориентированного программирования и разработки игр с графическим интерфейсом на Python, используя библиотеку Pygame, путём создания трёх различных игровых приложений.

\section{Описание задачи}

\begin{enumerate}
    \item Разработать многоуровневую игру «Лабиринт» с управляемым персонажем, врагами-антагонистами, усложняющейся структурой уровней
    \item Реализовать игру на свободную тему с графическим интерфейсом, включающую комплексную проверку ввода пользователя («защиту от дурака») и интуитивно понятное взаимодействие
    \item Создать интерактивную игру «Бутерброд», имитирующую процесс приготовления с использованием drag-and-drop механики, системой проверки корректности сборки и отслеживанием состояния игровых объектов
\end{enumerate}

\section{Ход выполнения}

\subsection{Игра «Лабиринт»}

\subsubsection{Концепция и игровой сеттинг}
В качестве тематического контекста для игры «Лабиринт» была выбрана концепция, аллегорически отражающая учебный процесс. 
Игровой мир представляет собой виртуальный университет.

Главный герой — студент, у которого осталась последняя и самая важная задолженность по зачёту. Его цель — добраться до учебного кабинета, чтобы исправить ситуацию. Однако путь преграждают преподаватели, патрулирующие коридоры. Встреча с любым из них грозит неприятным диалогом и, как следствие, провалом миссии.

\subsubsection{Проектирование уровней}
В ходе работы было спроектировано три игровых уровня, каждый из которых представляет собой замкнутый лабиринт с проходами и тупиками.

Ключевые принципы дизайна уровней:

\begin{enumerate}
    \item Визуальное обозначение границ: Все стены и непроходимые элементы лабиринта выполнены в едином чёрном цвете. Это решение преследует важную техническую цель: в среде разработки Scratch (или при использовании коллизий по цвету) это позволяет легко и эффективно определять столкновение игрового персонажа со стеной, не позволяя ему проходить сквозь преграды.
    \item Постепенное усложнение: Структура каждого последующего уровня усложняется по сравнению с предыдущим — увеличивается количество тупиков, появляются более длинные коридоры и сложные для обхода участки, что требует от игрока более продуманной тактики перемещения.
    \item Соблюдение условий: Дизайн уровней обеспечивает наличие стартовой точки для игрока, конечной цели (кабинет) и свободного пространства для патрулирования антагонистов (преподавателей).
\end{enumerate}

Внешний вид спроектированных уровней представлен на рисунке ниже

\begin{figure}[h]
\centering
\includegraphics[width=0.3\textwidth]{images/lr0/game1/level1.png}
\hfill
\includegraphics[width=0.3\textwidth]{images/lr0/game1/level2.png}
\hfill
\includegraphics[width=0.3\textwidth]{images/lr0/game1/level3.png}
\caption{Схемы уровней}
\end{figure}

\subsubsection{Спрайты}
Для создания уникального визуального стиля игры и полного соответствия выбранной тематике потребовался набор оригинальных спрайтов. 
Было принято стратегическое решение о генерации всех необходимых графических элементов с помощью нейросетевых инструментов.

Для реализации игровой механики и визуализации трех уровней сложности был сгенерирован следующий набор спрайтов:

\begin{enumerate}
    \item Главный герой (1 спрайт): Студент, которым управляет игрок
    \item Антагонисты (3 спрайта): Преподаватели, выполняющие роль противников. Каждый из трёх спрайтов уникален и соответствует одному из антагонистов, появляющихся на первом, втором и третьем уровне соответственно. Таким образом, увеличение сложности выражается не только в росте количества врагов, но и в их визуальном разнообразии.
\end{enumerate}

Итоговый дизайн спрайтов продемонстрирован ниже.

\begin{figure}[h]
\centering
\includegraphics[width=0.15\textwidth]{images/lr0/game1/sprites/player.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game1/sprites/prepod1.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game1/sprites/prepod2.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game1/sprites/prepod3.png}
\caption{Спрайты: первый - игрок, остальные - преподаватели}
\end{figure}

\subsubsection{Игровая реализация в Scratch}

Для реализации уровней используется глобальная переменная level, хранящая номер текущего уровня (1, 2 или 3).

Вместо постоянной проверки условий в цикле применяется событийная модель. Ключевым элементом является broadcast-сообщение «start», которое получают все спрайты. При его отправке:

\begin{itemize}
    \item Сцена меняет фон на соответствующий лабиринт.
    \item Антагонисты показываются или скрываются по правилу: «мой номер» ≤ «уровень».
    \item Все объекты возвращаются на стартовые позиции.
\end{itemize}

Триггеры для отправки этого сообщения:

\begin{itemize}
    \item Запуск игры
    \item Победа
\end{itemize}

Таким образом, игровая сцена обновляется при необходимости.

\imgh{0.5\textwidth}{images/lr0/game1/scene/code1.png}{Проинициализированные переменные при запуске игры}
\clearpage

\begin{figure}[h]
\centering
\includegraphics[width=0.4\textwidth]{images/lr0/game1/scene/code2.png}
\hfill
\includegraphics[width=0.4\textwidth]{images/lr0/game1/scene/code3.png}
\hfill
\caption{Слева - логика обработки broadcast-сообщения, справа - логика управления игроком через клавиатуру}
\end{figure}
\clearpage

\imgh{0.5\textwidth}{images/lr0/game1/scene/code4.png}{Логика при столкновении со стеной и «зачётом» (конец уровня)}
\imgh{0.5\textwidth}{images/lr0/game1/scene/code5.png}{Жизненный цикл одного из преподавателей уровня}
\clearpage


\subsection{Игра «мини пинг-понг»}

\subsubsection{Идея}

В качестве второй игры была реализована упрощённая версия классического «Пинг-понга» в жанре бесконечного аркадного симулятора.
Суть игры: игрок управляет одной ракеткой (платформой) в левой части экрана. Единственный игровой объект — мяч, который появляется в случайной точке и летит в случайном направлении с постоянной скоростью.

Геймплей и цель:

\begin{itemize}
    \item Цель: отбить мяч ракеткой
    \item Механика: Каждое успешное отражение мяча приносит игроку +1 очко
    \item Условие поражения: Если мяч коснулся нижней границы экрана (прошёл мимо ракетки), из общего счёта отнимается - очко.
\end{itemize}

\imgh{0.5\textwidth}{images/lr0/game2/scene.png}{Игровая сцена}

\subsubsection{Реализация}
Спрайт игрока содержит только логику управления, так как остальное входить в его зону ответственности.

\imgh{0.5\textwidth}{images/lr0/game2/player_logic.png}{Логика управления игрока}

Спрайт мяча содержит всю ключевую игровую механику. Его поведение управляется двумя основными блоками логики:
\begin{itemize}
    \item Выбор случайного направления
    \item Обработка столкновений
\end{itemize}

\imgh{0.5\textwidth}{images/lr0/game2/basketball.png}{Движение мяча}
\clearpage
\newpage

\subsection{Игра «Бутерброд»}

\subsubsection{Спрайты}
С помощью нейронных сетей были созданы спрайты, продемонстрированные в рисунках ниже.

\begin{figure}[h]
\centering
\includegraphics[width=0.3\textwidth]{images/lr0/game3/sprites/fridge_closed.png}
\hfill
\includegraphics[width=0.5\textwidth]{images/lr0/game3/sprites/fridge_opened.png}
\caption{Холодильник в двух состояниях}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.15\textwidth]{images/lr0/game3/sprites/vegetables/bread_bottom.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game3/sprites/vegetables/bread_top.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game3/sprites/vegetables/cucumber.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game3/sprites/vegetables/onion.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game3/sprites/vegetables/salad.png}
\hfill
\includegraphics[width=0.15\textwidth]{images/lr0/game3/sprites/vegetables/tomatoes.png}
\caption{Продукты}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.2\textwidth]{images/lr0/game3/cook/state1.png}
\hfill
\includegraphics[width=0.2\textwidth]{images/lr0/game3/cook/state2.png}
\hfill
\includegraphics[width=0.2\textwidth]{images/lr0/game3/cook/state3.png}
\caption{Повар в трёх состояниях}
\end{figure}

\imgh{0.7\textwidth}{images/lr0/game3/screenshot.png}{Итоговый дизайн игры}
\clearpage
\newpage

\subsubsection{Игровая логика}

Вся механика игры строится вокруг двух основных процессов, управляемых событиями (broadcast) и состояниями переменных:

\begin{enumerate}
    \item Цикл сборки: "Перенос продукта на тарелку"
        \begin{itemize}
            \item Триггер: Нажатие левой кнопки мыши на продукте в открытом холодильнике.
            \item Действие: Продукт «прилипает» к курсору (режим идти за указателем мыши).
            \item Завершение: При следующем клике на тарелке (или отпускании кнопки над ней) продукт фиксируется на позиции тарелки, а его идентификатор (ID) добавляется в конец списка. Этот список является цифровой рецептурой.
        \end{itemize}
    \item Цикл проверки: "Передача бутерброда на проверку"
        \begin{itemize}
            \item Триггер: Нажатие на кнопку или спрайт "Повар" / "Готово".
            \item Действие: Запускается финальный алгоритм проверки:
            \begin{itemize}
                \item Проверяется флаг холодильник открыт (должен быть ложь)
                \item Анализируется список "Собранный бутерброд" на соответствие шаблону: [Хлеб, ..., Хлеб] с минимум одним элементом между хлебами.
            \end{itemize}
            \item Исход: На основании проверки выводится результат
        \end{itemize}
\end{enumerate}

Каждый спрайт продукта (хлеб, сыр, колбаса и т.д.) в начальном состоянии скрыт, так как визуально находится внутри закрытого холодильника.
Видимость каждого продукта привязана к его уникальному идентификатору в общем списке (List). Продукт отображается на экране только тогда, когда его ID присутствует в специальном списке "Доступные продукты". При открытии холодильника ID всех продуктов добавляются в этот список, при закрытии — удаляются.

Финальная проверка срабатывает по нажатию кнопки «Готово». Алгоритм последовательно валидирует три обязательных условия победы:

\begin{enumerate}
\item Холодильник закрыт. Проверяется глобальный флаг холодильник открыт. Если значение истина — игра завершается поражением с соответствующим сообщением.
\item Бутерброд начинается и заканчивается хлебом. Анализируется список "Собранный бутерброд", в который последовательно заносятся ID добавленных на тарелку продуктов. Первый и последний элемент этого списка должны соответствовать ID хлеба.
\item Между хлебами есть начинка. Длина списка рецептуры бутерброда должна быть не менее 3 элементов (хлеб + минимум один продукт + хлеб). Если длина равна 2 (два хлеба подряд), выводится предупреждение "Это не бутерброд!".
\end{enumerate}

Результат: только при одновременном выполнении всех трёх условий игра регистрирует победу, выводя соответствующее поздравление. Визуальная схема работы блоков, отвечающих за продукты и проверку, представлена на изображениях ниже.

\imgh{0.7\textwidth}{images/lr0/game3/vegetable_code.png}{Жизненный цикл продукта}

\imgh{0.7\textwidth}{images/lr0/game3/core_logic.png}{Логика обработки рецептуры бутерброда}

\begin{figure}[h]
\centering
\includegraphics[width=0.6\textwidth]{images/lr0/game3/fail1.png}
\hfill
\includegraphics[width=0.6\textwidth]{images/lr0/game3/fail2.png}
\hfill
\includegraphics[width=0.6\textwidth]{images/lr0/game3/win.png}
\caption{Конец игры в трёх возможных состояниях}
\end{figure}
\clearpage
\newpage

\section{Вывод}

В результате лабораторной работы были разработаны и протестированы три игры, соответствующие техническому заданию: «Лабиринт», «Эндлесс-понг» и «Бутерброд». Освоены ключевые приёмы работы в Scratch: управление уровнями через broadcast-сообщения и глобальные переменные, обработка столкновений и событий мыши, реализация механики перетаскивания, а также валидация действий пользователя. Полученные проекты демонстрируют понимание основ событийно-ориентированного программирования и принципов создания интерактивных приложений. Цель работы достигнута.

Ссылки на игры:
\begin{itemize}
    \item https://scratch.mit.edu/projects/1262044581
    \item https://scratch.mit.edu/projects/1262225969
    \item https://scratch.mit.edu/projects/1262266640
\end{itemize}

\end{document}