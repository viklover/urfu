\usepackage{setspace}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{fontspec}
\usepackage{geometry}
\usepackage{tocloft}
\usepackage{graphicx}
\usepackage{caption}
\usepackage[hidelinks]{hyperref}
\usepackage{listings}
\usepackage{xcolor}

\lstset{
    language=Java,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    commentstyle=\color{green!50!black},
    stringstyle=\color{red},
    showstringspaces=false,
    frame=single,
    breaklines=true
}

% Шрифт
\setmainfont{Times New Roman}[
    Path = ./fonts/,
    UprightFont = times.ttf,
    BoldFont = timesbd.ttf,
    ItalicFont = timesi.ttf,
    BoldItalicFont = timesbi.ttf
]

% Поля документа
\geometry{left=2cm}% левое поле
\geometry{right=3cm}% правое поле
\geometry{top=1cm}% верхнее поле
\geometry{bottom=2cm}% нижнее поле

% Вставка изображений
\renewcommand{\figurename}{Рисунок}
\captionsetup[figure]{labelsep=period}
\newcommand{\imgh}[3] {
    \begin{figure}[h]
    \center{\includegraphics[width=#1]{#2}}
    \caption{#3}
    \label{ris:#2}
    \end{figure}
}

% Настройки оглавления
\renewcommand{\contentsname}{\hfill\bfseries\Large Оглавление\hfill}   
\renewcommand{\cftaftertoctitle}{\hfill}
\renewcommand{\cftafterlottitle}{\hfill}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsecfont}{\fontsize{14}{17}\selectfont}
\renewcommand{\cftsecpagefont}{\fontsize{14}{17}\selectfont}
\renewcommand{\cftsubsecfont}{\fontsize{14}{17}\selectfont}
\renewcommand{\cftsecfont}{\large\normalfont}
\renewcommand{\cftsecpagefont}{\large\normalfont}
\hypersetup{
    colorlinks=false,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Отчет},
}

% Полуторный межстрочный
\onehalfspacing

% Красная строка
\setlength{\parindent}{1.25cm}

\newcommand{\maketitlepage}[1]{
  \begin{titlepage}
  \thispagestyle{empty}

  % Верхняя часть - по центру
  \begin{center}
  \LARGE Уральский федеральный университет
  \end{center}

  % Пропускаем пространство до середины
  \vspace*{\stretch{2}}

  % Средняя часть - по центру
  \begin{center}
  \bfseries\Huge Отчет по \\
  \bfseries\Huge Лабораторной работе №#1
  \end{center}

  % Пропускаем немного
  \vspace*{\stretch{3}}

  % Информация о студенте - выравнивание по левому краю
  \begin{flushleft}
  \large
  \textbf{Студент:} Воробьев Михаил Сергеевич, \\
  \textbf{Группа:} РИЗ-150916у
  \end{flushleft}

  % Пропускаем до низа
  \vfill

  % Нижняя часть - по центру
  \begin{center}
  \large Екатеринбург, \\
  \large 2026 год
  \end{center}

  \end{titlepage}
}